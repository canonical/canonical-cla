name: canonical-cla
summary: Canonical Contribution Licence Agreement (CLA) Service.
description: OCI image for the Python service - Canonical CLA
version: "0.1"
base: ubuntu@22.04

platforms:
  amd64:
  arm64:

parts:
  app:
    plugin: python
    source: .
    build-packages:
      - libpq-dev
      - libssl-dev
      - libffi-dev
    stage-packages:
      - python3-venv
      - libpq5
      # needed for rotatelogs used in the app service command
      - apache2-utils
    python-requirements:
      - requirements.txt

  app-files:
    plugin: dump
    source: .
    override-pull: |
      craftctl default
      # Ignored files/directories
      rm -rf rockcraft.yaml .env .gitignore .git docker-compose.yaml
    organize:
      "*": /srv/
    prime:
      - srv